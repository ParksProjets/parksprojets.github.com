// GSJS by Parks Projets
var Stats=function(){var I,P,C=0,B=0,H=Date.now(),v=H,A=H,E=0,z=1000,y=0,L,G,K,O=[[16,16,48],[0,255,255]],D=0,x=1000,w=0,M,F,J,N=[[16,48,16],[0,255,0]];I=document.createElement("div");I.style.cursor="pointer";I.style.width="80px";I.style.opacity="0.9";I.style.zIndex="10001";I.addEventListener("mousedown",function(b){b.preventDefault();C=(C+1)%2;C==0?(L.style.display="block",M.style.display="none"):(L.style.display="none",M.style.display="block")},!1);L=document.createElement("div");L.style.textAlign="left";L.style.lineHeight="1.2em";L.style.backgroundColor="rgb("+Math.floor(O[0][0]/2)+","+Math.floor(O[0][1]/2)+","+Math.floor(O[0][2]/2)+")";L.style.padding="0 0 3px 3px";I.appendChild(L);G=document.createElement("div");G.style.fontFamily="Helvetica, Arial, sans-serif";G.style.fontSize="9px";G.style.color="rgb("+O[1][0]+","+O[1][1]+","+O[1][2]+")";G.style.fontWeight="bold";G.innerHTML="FPS";L.appendChild(G);K=document.createElement("div");K.style.position="relative";K.style.width="74px";K.style.height="30px";K.style.backgroundColor="rgb("+O[1][0]+","+O[1][1]+","+O[1][2]+")";for(L.appendChild(K);K.children.length<74;){P=document.createElement("span"),P.style.width="1px",P.style.height="30px",P.style.cssFloat="left",P.style.backgroundColor="rgb("+O[0][0]+","+O[0][1]+","+O[0][2]+")",K.appendChild(P)}M=document.createElement("div");M.style.textAlign="left";M.style.lineHeight="1.2em";M.style.backgroundColor="rgb("+Math.floor(N[0][0]/2)+","+Math.floor(N[0][1]/2)+","+Math.floor(N[0][2]/2)+")";M.style.padding="0 0 3px 3px";M.style.display="none";I.appendChild(M);F=document.createElement("div");F.style.fontFamily="Helvetica, Arial, sans-serif";F.style.fontSize="9px";F.style.color="rgb("+N[1][0]+","+N[1][1]+","+N[1][2]+")";F.style.fontWeight="bold";F.innerHTML="MS";M.appendChild(F);J=document.createElement("div");J.style.position="relative";J.style.width="74px";J.style.height="30px";J.style.backgroundColor="rgb("+N[1][0]+","+N[1][1]+","+N[1][2]+")";for(M.appendChild(J);J.children.length<74;){P=document.createElement("span"),P.style.width="1px",P.style.height=Math.random()*30+"px",P.style.cssFloat="left",P.style.backgroundColor="rgb("+N[0][0]+","+N[0][1]+","+N[0][2]+")",J.appendChild(P)}return{domElement:I,update:function(){H=Date.now();D=H-v;x=Math.min(x,D);w=Math.max(w,D);F.textContent=D+" MS ("+x+"-"+w+")";var b=Math.min(30,30-D/200*30);J.appendChild(J.firstChild).style.height=b+"px";v=H;B++;if(H>A+1000){E=Math.round(B*1000/(H-A)),z=Math.min(z,E),y=Math.max(y,E),G.textContent=E+" FPS ("+z+"-"+y+")",b=Math.min(30,30-E/100*30),K.appendChild(K.firstChild).style.height=b+"px",A=H,B=0}}}};var Detector={canvas:!!window.CanvasRenderingContext2D,webgl:(function(){try{return !!window.WebGLRenderingContext&&!!document.createElement("canvas").getContext("experimental-webgl")}catch(a){return false}})(),workers:!!window.Worker,fileapi:window.File&&window.FileReader&&window.FileList&&window.Blob};THREE.OrbitControls=function(D,C){this.object=D;this.domElement=(C!==undefined)?C:document;this.enabled=true;this.target=new THREE.Vector3();this.center=this.target;this.noZoom=false;this.zoomSpeed=1;this.minDistance=0;this.maxDistance=Infinity;this.noRotate=false;this.rotateSpeed=1;this.noPan=false;this.keyPanSpeed=7;this.autoRotate=false;this.autoRotateSpeed=2;this.minPolarAngle=0;this.maxPolarAngle=Math.PI;this.noKeys=false;this.keys={LEFT:37,UP:38,RIGHT:39,BOTTOM:40};var a=this;var r=0.000001;var y=new THREE.Vector2();var f=new THREE.Vector2();var n=new THREE.Vector2();var c=new THREE.Vector2();var k=new THREE.Vector2();var x=new THREE.Vector2();var b=new THREE.Vector2();var s=new THREE.Vector2();var v=new THREE.Vector2();var h=0;var B=0;var E=1;var q=new THREE.Vector3();var p=new THREE.Vector3();var u={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_DOLLY:4,TOUCH_PAN:5};var g=u.NONE;var A={type:"change"};this.rotateLeft=function(F){if(F===undefined){F=i()}B-=F};this.rotateUp=function(F){if(F===undefined){F=i()}h-=F};this.panLeft=function(H){var F=new THREE.Vector3();var G=this.object.matrix.elements;F.set(G[0],G[1],G[2]);F.multiplyScalar(-H);q.add(F)};this.panUp=function(H){var F=new THREE.Vector3();var G=this.object.matrix.elements;F.set(G[4],G[5],G[6]);F.multiplyScalar(H);q.add(F)};this.pan=function(J){var G=a.domElement===document?a.domElement.body:a.domElement;if(a.object.fov!==undefined){var F=a.object.position;var I=F.clone().sub(a.target);var H=I.length();H*=Math.tan((a.object.fov/2)*Math.PI/180);a.panLeft(2*J.x*H/G.clientHeight);a.panUp(2*J.y*H/G.clientHeight)}else{if(a.object.top!==undefined){a.panLeft(J.x*(a.object.right-a.object.left)/G.clientWidth);a.panUp(J.y*(a.object.top-a.object.bottom)/G.clientHeight)}else{console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled.")}}};this.dollyIn=function(F){if(F===undefined){F=t()}E/=F};this.dollyOut=function(F){if(F===undefined){F=t()}E*=F};this.update=function(){var G=this.object.position;var J=G.clone().sub(this.target);var H=Math.atan2(J.x,J.z);var I=Math.atan2(Math.sqrt(J.x*J.x+J.z*J.z),J.y);if(this.autoRotate){this.rotateLeft(i())}H+=B;I+=h;I=Math.max(this.minPolarAngle,Math.min(this.maxPolarAngle,I));I=Math.max(r,Math.min(Math.PI-r,I));var F=J.length()*E;F=Math.max(this.minDistance,Math.min(this.maxDistance,F));this.target.add(q);J.x=F*Math.sin(I)*Math.sin(H);J.y=F*Math.cos(I);J.z=F*Math.sin(I)*Math.cos(H);G.copy(this.target).add(J);this.object.lookAt(this.target);B=0;h=0;E=1;q.set(0,0,0);if(p.distanceTo(this.object.position)>0){this.dispatchEvent(A);p.copy(this.object.position)}};function i(){return 2*Math.PI/60/60*a.autoRotateSpeed}function t(){return Math.pow(0.95,a.zoomSpeed)}function j(F){if(a.enabled===false){return}F.preventDefault();if(F.button===0){if(a.noRotate===true){return}g=u.ROTATE;y.set(F.clientX,F.clientY)}else{if(F.button===1){if(a.noZoom===true){return}g=u.DOLLY;b.set(F.clientX,F.clientY)}else{if(F.button===2){if(a.noPan===true){return}g=u.PAN;c.set(F.clientX,F.clientY)}}}a.domElement.addEventListener("mousemove",m,false);document.addEventListener("mouseup",e,false)}function m(G){if(a.enabled===false){return}G.preventDefault();var F=a.domElement===document?a.domElement.body:a.domElement;if(g===u.ROTATE){if(a.noRotate===true){return}f.set(G.clientX,G.clientY);n.subVectors(f,y);a.rotateLeft(2*Math.PI*n.x/F.clientWidth*a.rotateSpeed);a.rotateUp(2*Math.PI*n.y/F.clientHeight*a.rotateSpeed);y.copy(f)}else{if(g===u.DOLLY){if(a.noZoom===true){return}s.set(G.clientX,G.clientY);v.subVectors(s,b);if(v.y>0){a.dollyIn()}else{a.dollyOut()}b.copy(s)}else{if(g===u.PAN){if(a.noPan===true){return}k.set(G.clientX,G.clientY);x.subVectors(k,c);a.pan(x);c.copy(k)}}}a.update()}function e(){if(a.enabled===false){return}a.domElement.removeEventListener("mousemove",m,false);a.domElement.removeEventListener("mouseup",e,false);g=u.NONE}function l(F){if(a.enabled===false||a.noZoom===true){return}var G=0;if(F.wheelDelta){G=F.wheelDelta}else{if(F.detail){G=-F.detail}}if(G>0){a.dollyOut()}else{a.dollyIn()}}function d(F){if(a.enabled===false){return}if(a.noKeys===true){return}if(a.noPan===true){return}var G=false;switch(F.keyCode){case a.keys.UP:a.pan(new THREE.Vector2(0,a.keyPanSpeed));G=true;break;case a.keys.BOTTOM:a.pan(new THREE.Vector2(0,-a.keyPanSpeed));G=true;break;case a.keys.LEFT:a.pan(new THREE.Vector2(a.keyPanSpeed,0));G=true;break;case a.keys.RIGHT:a.pan(new THREE.Vector2(-a.keyPanSpeed,0));G=true;break}if(G){a.update()}}function w(H){if(a.enabled===false){return}switch(H.touches.length){case 1:if(a.noRotate===true){return}g=u.TOUCH_ROTATE;y.set(H.touches[0].pageX,H.touches[0].pageY);break;case 2:if(a.noZoom===true){return}g=u.TOUCH_DOLLY;var G=H.touches[0].pageX-H.touches[1].pageX;var F=H.touches[0].pageY-H.touches[1].pageY;var I=Math.sqrt(G*G+F*F);b.set(0,I);break;case 3:if(a.noPan===true){return}g=u.TOUCH_PAN;c.set(H.touches[0].pageX,H.touches[0].pageY);break;default:g=u.NONE}}function o(I){if(a.enabled===false){return}I.preventDefault();I.stopPropagation();var H=a.domElement===document?a.domElement.body:a.domElement;switch(I.touches.length){case 1:if(a.noRotate===true){return}if(g!==u.TOUCH_ROTATE){return}f.set(I.touches[0].pageX,I.touches[0].pageY);n.subVectors(f,y);a.rotateLeft(2*Math.PI*n.x/H.clientWidth*a.rotateSpeed);a.rotateUp(2*Math.PI*n.y/H.clientHeight*a.rotateSpeed);y.copy(f);break;case 2:if(a.noZoom===true){return}if(g!==u.TOUCH_DOLLY){return}var G=I.touches[0].pageX-I.touches[1].pageX;var F=I.touches[0].pageY-I.touches[1].pageY;var J=Math.sqrt(G*G+F*F);s.set(0,J);v.subVectors(s,b);if(v.y>0){a.dollyOut()}else{a.dollyIn()}b.copy(s);break;case 3:if(a.noPan===true){return}if(g!==u.TOUCH_PAN){return}k.set(I.touches[0].pageX,I.touches[0].pageY);x.subVectors(k,c);a.pan(x);c.copy(k);break;default:g=u.NONE}}function z(){if(a.enabled===false){return}g=u.NONE}this.domElement.addEventListener("contextmenu",function(F){F.preventDefault()},false);this.domElement.addEventListener("mousedown",j,false);this.domElement.addEventListener("mousewheel",l,false);this.domElement.addEventListener("DOMMouseScroll",l,false);this.domElement.addEventListener("keydown",d,false);this.domElement.addEventListener("touchstart",w,false);this.domElement.addEventListener("touchend",z,false);this.domElement.addEventListener("touchmove",o,false)};THREE.OrbitControls.prototype=Object.create(THREE.EventDispatcher.prototype);var GSJS=function(x){var g=this;if(x===undefined){x={}}this.container=x.container;var N=x.ortho||false;var w=x.debug||false;var i=x.autoRun||false;if(x.container&&x.container instanceof jQuery===false){this.container=$(x.container)}if(!x.container){this.container=$("<div></div>");$("body").append(this.container)}this.container.css("padding",0);if(this.container.css("position")=="static"){this.container.css("position","relative")}if(x.useWebGL!==false&&Detector.webgl){this.useWebGL=true}else{this.useWebGL=false}M();function M(){var Q=g.container.width(),P=g.container.height();if(N){g.camera=new THREE.OrthographicCamera(Q/-2,Q/2,P/2,P/-2,1,1000)}else{g.camera=new THREE.PerspectiveCamera(70,Q/P,1,1000)}g.camera.position.z=400;g.scene=new THREE.Scene();g.points=new THREE.Object3D();g.lines=new THREE.Object3D();g.faces=new THREE.Object3D();g.scene.add(g.points);g.scene.add(g.lines);g.scene.add(g.faces);if(g.useWebGL){g.renderer=new THREE.WebGLRenderer({antialias:true})}else{g.renderer=new THREE.CanvasRenderer()}g.renderer.setSize(Q,P);g.renderer.setClearColor(14869218,1);g.container.append(g.renderer.domElement);g.controls=new THREE.OrbitControls(g.camera,g.renderer.domElement);if(w){g.stats=new Stats();g.stats.domElement.style.position="absolute";g.stats.domElement.style.top="0px";g.container.append(g.stats.domElement)}if(i){g.animate()}return true}this.run=function(){if(!i){i=true;g.animate()}return g};this.animate=function(){requestAnimationFrame(g.animate);D();if(w){g.stats.update()}};this.loadObject=function(T){var S=[];for(var Q=0;Q<T.vertex.length;Q++){S.push(new THREE.Vector3(T.vertex[Q][0],T.vertex[Q][1],T.vertex[Q][2]).multiplyScalar(0.9))}for(var Q=0;Q<T.edges.length;Q++){g.createSegment(S[T.edges[Q][0]],S[T.edges[Q][1]],13369344)}if(T.names!==undefined){for(var Q=0;Q<T.names.length;Q++){if(T.names[Q]){g.createPoint(S[Q],T.names[Q],0)}}}for(var W=0;W<T.faces.length;W++){var U=new THREE.Geometry();var R=0;var P=new THREE.MeshBasicMaterial({color:15790320,vertexColors:THREE.FaceColors,side:THREE.DoubleSide});for(var Q=0;Q<T.faces[W].length;Q++){U.vertices[Q]=S[T.faces[W][Q]].clone().multiplyScalar(0.996)}for(var Q=0;Q<T.faces[W].length-2;Q++){U.faces[R]=new THREE.Face3(0,Q+1,Q+2);U.faces[R].color=new THREE.Color(15790320);R++}U.computeFaceNormals();U.computeVertexNormals();var V=new THREE.Mesh(U,P);V.type="face";g.faces.add(V)}return g};function O(){g.scene.remove(g.faces);g.renderer.render(g.scene,g.camera);g.scene.add(g.faces);g.renderer.render(g.scene,g.camera)}function D(){g.controls.update();for(var P=0;P<g.points.children.length;P++){g.points.children[P].lookAt(g.camera.position)}K();g.renderer.render(g.scene,g.camera)}g.container.bind("mousemove",G);g.renderer.domElement.addEventListener("mousedown",B,false);g.renderer.domElement.addEventListener("mouseup",f,false);$(g.renderer.domElement).dblclick(v);$(window).resize(L);function L(R){var Q=g.container.width(),P=g.container.height();g.camera.aspect=Q/P;g.camera.updateProjectionMatrix();g.renderer.setSize(Q,P)}var C=new THREE.Vector2();function G(P){C.x=((P.pageX-g.container.offset().left)/g.container.width())*2-1;C.y=-((P.pageY-g.container.offset().top)/g.container.height())*2+1}var j;function B(P){j=C.clone()}function f(Q){if(j.x==C.x&&j.y==C.y){if(Q.button===2){K(true);if(n!==undefined){g.ShowContextMenu(n[0])}else{g.ShowContextMenu()}}else{for(var P=0;P<F.length;P++){F[P]()}}}}function v(P){K(true);if(n!==undefined){g.ShowEditMenu(n[0])}}var F=new Array();g.addMouseDownEvent=function(P){if(F.indexOf(P)===-1){F.push(P)}};g.removeMouseDownEvent=function(P){if(F.indexOf(P)!==-1){F.splice(P,1)}};var y=new Array();g.bind=function(P,Q){if(y[P]===undefined){y[P]=new Array()}if(y[P].indexOf(Q)===-1){y[P].push(Q)}return g};g.unbind=function(P,Q){if(y[P]!==undefined){if(y[P].indexOf(Q)!==-1){y[P].splice(Q,1)}}return g};function b(Q,R){R=R||{};if(y[Q]!==undefined){R.type=Q;for(var P=0;P<y[Q].length;P++){y[Q][P](R)}}}this.createPoint=function(S,Z,X){if(S instanceof THREE.Vector3===false){S=new THREE.Vector3(S.x||S[0],S.y||S[1],S.z||S[2])}if(X===undefined||X>1){X=1}var T=new THREE.Geometry();T.vertices=[new THREE.Vector3(-3,-3,0),new THREE.Vector3(-3,3,0),new THREE.Vector3(3,3,0),new THREE.Vector3(3,-3,0)];T.faces=[new THREE.Face3(0,1,2),new THREE.Face3(2,3,0)];var V=new THREE.Mesh(T,new THREE.MeshBasicMaterial({color:10079385,side:THREE.DoubleSide,visible:false}));V.position.copy(S);V.nom=Z;V.type="point";g.points.add(V);var Q=l(Z);Q.position.copy(S).multiplyScalar(1.06);g.scene.add(Q);V.texte=Q;if(X!==0){var R=document.createElement("canvas");var aa=256;R.width=aa;R.height=aa;var P=R.getContext("2d");P.beginPath();P.lineWidth=8;P.moveTo(0,0);P.lineTo(256,256);P.moveTo(0,256);P.lineTo(256,0);P.strokeStyle="#ffffff";P.stroke();var U=new THREE.Texture(R);U.needsUpdate=true;var Y=new THREE.SpriteMaterial({map:U,transparent:false,useScreenCoordinates:false,color:2236996,depthTest:false});var W=new THREE.Sprite(Y);W.scale.set(5,5,1);W.position.copy(S);g.scene.add(W);V.figure=W}b("createPoint",{name:Z,x:S.x,y:S.y,z:S.z});return g};function l(V){var Q=document.createElement("canvas");var T=256;Q.width=T;Q.height=T;var S=Q.getContext("2d");S.fillStyle="#ffffff";S.textAlign="center";S.font="128px Arial";S.fillText(V,T/2,T/2);var P=new THREE.Texture(Q);P.needsUpdate=true;var R=new THREE.SpriteMaterial({map:P,transparent:false,useScreenCoordinates:false,color:2236996,depthTest:false});var U=new THREE.Sprite(R);U.scale.set(24,24,1);return U}this.getPointByName=function(Q){var S={};for(var R=0;R<g.points.children.length;R++){if(g.points.children[R].nom==Q){var P=g.points.children[R];S.x=P.position.x;S.y=P.position.y;S.z=P.position.z;S.name=P.nom;return S}}return null};this.getPointByPosition=function(Q,U){if(Q instanceof THREE.Vector3===false){Q=new THREE.Vector3(Q.x||Q[0],Q.y||Q[1],Q.z||Q[2])}if(U===undefined){U=1}var S={};for(var R=0;R<g.points.children.length;R++){var P=g.points.children[R],V=Q.distanceTo(P.position);if(V<U&&(!S.distance||S.distance>V)){S.distance=V;S.obj=P}}if(S.obj){var T={};T.x=S.obj.position.x;T.y=S.obj.position.y;T.z=S.obj.position.z;T.name=S.obj.nom;return T}return null};this.createDroite=function(R,P,S){if(R instanceof THREE.Vector3===false){var R=new THREE.Vector3(R.x||R[0],R.y||R[1],R.z||R[2])}if(!P instanceof THREE.Vector3===false){var P=new THREE.Vector3(P.x||P[0],P.y||P[1],P.z||P[2])}S=S||204;const Q=2000;var V=R.distanceTo(P);var U=new THREE.Vector3();var T=new THREE.Vector3();U.subVectors(P,R).multiplyScalar(Q/V).add(R);T.subVectors(R,P).multiplyScalar(Q/V).add(P);b("createDroite",{color:S});return g.createSegment(T,U,S,false)};this.createDemiDroite=function(R,P,T){if(R instanceof THREE.Vector3===false){R=new THREE.Vector3(R.x||R[0],R.y||R[1],R.z||R[2])}if(!P instanceof THREE.Vector3===false){P=new THREE.Vector3(P.x||P[0],P.y||P[1],P.z||P[2])}T=T||204;const Q=1000;var U=R.distanceTo(P);var S=new THREE.Vector3();S.subVectors(P,R).multiplyScalar(Q/U).add(R);b("createDemiDroite",{color:T});return g.createSegment(R,S,T,false)};this.createSegment=function(Q,P,R,U){if(Q instanceof THREE.Vector3===false){var Q=new THREE.Vector3(Q.x||Q[0],Q.y||Q[1],Q.z||Q[2])}if(P instanceof THREE.Vector3===false){var P=new THREE.Vector3(P.x||P[0],P.y||P[1],P.z||P[2])}R=R||2991515;if(U===undefined){U=true}var T=new THREE.Geometry();T.vertices.push(Q,P);T.computeLineDistances();var S=new THREE.Object3D();S.add(new THREE.Line(T,new THREE.LineBasicMaterial({color:R})));S.add(new THREE.Line(T,new THREE.LineDashedMaterial({color:R,dashSize:15,gapSize:10,depthTest:false})));S.type="line";S.initialColor=R;g.scene.add(S);O();if(U){b("createSegment",{color:R})}return g};var E=new THREE.Raycaster();var J=new THREE.Projector();var n=undefined;var h;function K(X){a();if(m==0&&!X){return false}var Q=new THREE.Vector3(C.x,C.y,0.5);if(N){var W=J.pickingRay(Q,g.camera);var U=W.intersectObjects(g.scene.children,true)}else{J.unprojectVector(Q,g.camera);E.set(g.camera.position,Q.sub(g.camera.position).normalize());var U=E.intersectObjects(g.scene.children,true)}if(U.length>0){var T=new Array();for(var S=0;S<U.length;S++){if(U[S].object.type=="point"){T.push(U[S]);break}}if(T==0){for(var S=0;S<U.length;S++){if(U[S].object.parent.type=="line"){T.push(U[S])}}if(T.length==0){T.push(U[0])}}n=new Array();var P=new Array(),V=new Array();for(var S=0;S<T.length;S++){n[S]=T[S].object;if(n[S].type=="point"){n[S].texte.material.color.setHex(52224);if(n[S].figure){n[S].figure.material.color.setHex(52224)}V.push(n[S])}else{n[S].material.color.setHex(52224);if(n[S].material instanceof THREE.LineDashedMaterial){P.push(n[S])}}}if(V.length==0){if(P.length>1){var W=new THREE.Raycaster();W.set(P[0].geometry.vertices[0],P[0].geometry.vertices[1].clone().normalize());var R=E.intersectObject(P[1]);if(R.length==1){h=R[0].point}else{h=T[0].point}}else{h=T[0].point}}else{h=V[0].position}}}function a(){if(n!==undefined){for(var P=0;P<n.length;P++){if(n[P].type=="point"){n[P].texte.material.color.setHex(2236996);if(n[P].figure){n[P].figure.material.color.setHex(2236996)}}else{if(n[P].type=="face"){n[P].material.color.setHex(n[P].initialColor||15790320)}else{n[P].material.color.setHex(n[P].parent.initialColor||13369344)}}}n=undefined}}$("head").append('<style type="text/css">#GSJSContextMenu{box-sizing:initial;position:absolute;width:200px;background:#BABACF;box-shadow:2px 2px 4px #797979}#GSJSContextMenu>div{box-sizing:initial;height:30px;padding:0 20px;font:16px Arial;transition:background .3s;cursor:default;color:#4B4545;line-height:30px}#GSJSContextMenu>div:hover{background:#A3A3BB}#GSJSEditMenu{box-sizing:initial;position:absolute;top:0;right:0}#GSJSEditMenu>div{height:37px;overflow:hidden}#GSJSEditMenu>div>div{box-sizing:initial;height:25px;padding:5px;width:250px;background:#635D6E;font:17px Arial;color:#F5F5F5;line-height:25px;border-bottom:2px solid #3F3F3F}#GSJSEditMenu label{font:17px Arial;color:#F5F5F5;line-height:25px}#GSJSEditMenu input{background:#9492A0;border:0;height:25px;float:right;padding:0 10px;width:140px;font:18px Arial;color:#007E00}#GSJSEditMenu .ok>div{height:19px;text-align:center;padding:0 5px;font-size:13px;line-height:19px;border-bottom:0;cursor:pointer;transition: background .4s}#GSJSEditMenu .ok>div:hover{background: #746499}</style>');var t=$('<div id="GSJSContextMenu"></div>');t.hide();$(g.container).append(t);$(document).bind("mousedown",function(){if(!$("#GSJSContextMenu:hover").length>0){g.HideContextMenu()}});var q=$('<div id="GSJSEditMenu"><div class="name"><div><label>Nom</label><input></div></div><div class="ok"><div>Fermer</div></div></div>');q.hide();$(g.container).append(q);var u=false;var k=undefined;g.ShowContextMenu=function(P){if(!g.ContextMenuActive){return}if(P!==undefined){k=P;t.find(".onlyIfObject").show()}else{t.find(".onlyIfObject").hide()}t.css({left:((C.x+1)/2*g.container.width()+1)+"px",top:(g.container.height()-(C.y+1)/2*g.container.height()+1)+"px"}).fadeIn("fast");u=true;return g};g.HideContextMenu=function(){if(!u){return}k=undefined;t.hide();u=false;return g};g.addToContextMenu=function(Q,S,P){P=P||false;var R=$("<div"+(P?' class="onlyIfObject"':"")+">"+Q+"</div>");R.click(S);R.click(function(){g.HideContextMenu()});t.prepend(R);return g};g.ContextMenuActive=true;g.addToContextMenu("A Propos",function(){alert("(c) Parks Projet")});g.addToContextMenu("Paramètres",function(){});g.addToContextMenu("Options de l'objet",function(){g.ShowEditMenu(k)},true);var H=false;var s=undefined;g.ShowEditMenu=function(P){if(P===undefined){return g}s=P;q.find(".name input").val(P.nom||"");q.fadeIn();H=true;return g};g.HideEditMenu=function(){if(!H){return g}s=undefined;q.fadeOut();H=false;return g};$("#GSJSEditMenu .ok").click(function(){g.HideEditMenu()});$("#GSJSEditMenu .name input").bind("propertychange keyup input paste",function(){if(!s||!s.texte){return}s.texte.material=l($(this).val()).material;s.nom=$(this).val()});var I={addPoint:new Array(),addDroite:new Array(),addSegment:new Array()};var m=0;g.Interface={};g.Interface.addDefaultInterface=function(){$("head").append('<style type="text/css">#J3DDefaultInterface{position:absolute;bottom:15px;right:15px}#J3DDefaultInterface>div{height:50px;width:50px;border:2px solid #9C9C9C;border-radius:7px;background:#fff;float:left;margin-left:12px;cursor:pointer;transition:border-color .4s,background .5s}#J3DDefaultInterface>div:hover{border-color:#7F74CC}#J3DDefaultInterface>div.active{background:#aecfff;border-color:#7F74CC}</style>');var S=$('<div id="J3DDefaultInterface"></div>');var Q=["addPoint","addDroite","addSegment"];var P=["Ajouter un point","Ajouter une droite","Ajouter un segment"];for(var R=0;R<Q.length;R++){var T=$('<div id="'+Q[R]+'" title="'+P[R]+'"></div>');T.css("background-image","url("+Q[R]+".png)");g.Interface.addControlButton(Q[R],T);S.append(T)}g.container.append(S);return g.Interface};g.Interface.addControlButton=function(Q,P){if(P instanceof jQuery===false){P=$(P)}switch(Q){case"addPoint":P.click(g.Interface.TriggerAddPoint);if(I.addPoint.indexOf(P)===-1){I.addPoint.push(P)}break;case"addDroite":P.click(g.Interface.TriggerAddDroite);if(I.addDroite.indexOf(P)===-1){I.addDroite.push(P)}break;case"addSegment":P.click(g.Interface.TriggerAddSegment);if(I.addSegment.indexOf(P)===-1){I.addSegment.push(P)}break;default:console.warn('J3D.Interface.addControlButton(): "'+Q+'" est un type inconnu.')}return g.Interface};g.Interface.removeControlButton=function(Q,P){if(P instanceof jQuery===false){P=$(P)}switch(Q){case"addPoint":P.off("click",g.Interface.TriggerAddPoint);if(I.addPoint.indexOf(P)!==-1){I.addPoint.splice(P,1)}break;case"addDroite":P.off("click",g.Interface.TriggerAddDroite);if(I.addDroite.indexOf(P)!==-1){I.addDroite.splice(P,1)}break;case"addSegment":P.off("click",g.Interface.TriggerAddSegment);if(I.addSegment.indexOf(P)!==-1){I.addSegment.splice(P,1)}break;default:console.warn('J3D.Interface.removeControlButton(): "'+Q+'" est un type inconnu.')}return g.Interface};function c(Q,P){var S=m;g.Interface.ResetControls();if(S!=Q){for(var R=0;R<P.length;R++){P[R].addClass("active")}m=Q;return true}else{return false}}g.Interface.TriggerAddPoint=function(){var P=false;if(c(1,I.addPoint)){g.addMouseDownEvent(r);P=true}b("TriggerAddPoint",{active:P});return g.Interface};g.Interface.TriggerAddDroite=function(){var P=false;if(c(2,I.addDroite)){g.addMouseDownEvent(e);P=true}b("TriggerAddDroite",{active:P});return g.Interface};g.Interface.TriggerAddSegment=function(){var P=false;if(c(3,I.addSegment)){g.addMouseDownEvent(A);P=true}b("TriggerAddSegment",{active:P});return g.Interface};g.Interface.ResetControls=function(Q){if(Q!==false){g.removeMouseDownEvent(r);g.removeMouseDownEvent(e);g.removeMouseDownEvent(d);g.removeMouseDownEvent(A);g.removeMouseDownEvent(z)}for(index in I){for(var P=0;P<I[index].length;P++){I[index][P].removeClass("active")}}m=0;return g.Interface};function r(P){if(n!==undefined){g.Interface.ResetControls();g.createPoint(h,"T")}}var p;function e(P){if(n!==undefined){g.removeMouseDownEvent(e);g.addMouseDownEvent(d);p=h}}function d(P){if(n!==undefined){g.Interface.ResetControls();g.createDroite(p,h)}}var o;function A(P){if(n!==undefined){g.removeMouseDownEvent(A);g.addMouseDownEvent(z);o=h}}function z(P){if(n!==undefined){g.Interface.ResetControls();g.createSegment(o,h)}}};
